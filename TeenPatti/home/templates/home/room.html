{% extends "home/base.html" %}
{% block content %}
<h1>Room: {{ room_code }}</h1>

{% if not waiting_for_more_players %}
  {% if not current_player.has_played %}
    <form method="post" action="/play/{{ room_code }}/">
      {% csrf_token %}
      <button type="submit">Play My Card</button>
    </form>
  {% else %}
    <p>Waiting for others to play...</p>
  {% endif %}
{% else %}
  <p>Waiting for players to join... ({{ players|length }}/3)</p>
{% endif %}

{% if player_count < 3 %}
<form method="post" action="/add-bot/{{ room_code }}/">
  {% csrf_token %}
  <button type="submit" style="padding: 10px 20px;">‚ûï Add Bot</button>
</form>
{% endif %}

<h3>Players:</h3>
<ul>
  {% for p in players %}
    <li>
      {% if p.is_bot %}
        ü§ñ Bot
      {% elif p.user %}
        {{ p.user.username|default:p.user.email }}
      {% else %}
        Guest
      {% endif %}
      - {% if p.has_played %} ‚úÖ Played {% else %} ‚è≥ Waiting {% endif %}
    </li>
  {% endfor %}
</ul>

<script>
  setInterval(() => {
      location.reload();
  }, 3000);
</script>
{% endblock %}
